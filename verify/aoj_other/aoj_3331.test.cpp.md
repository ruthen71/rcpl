---
data:
  _extendedDependsOn:
  - icon: ':x:'
    path: icpc/modint.hpp
    title: icpc/modint.hpp
  - icon: ':x:'
    path: icpc/ntt.hpp
    title: icpc/ntt.hpp
  - icon: ':question:'
    path: icpc/template.hpp
    title: icpc/template.hpp
  _extendedRequiredBy: []
  _extendedVerifiedWith: []
  _isVerificationFailed: true
  _pathExtension: cpp
  _verificationStatusIcon: ':x:'
  attributes:
    '*NOT_SPECIAL_COMMENTS*': ''
    PROBLEM: https://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=3331
    links:
    - https://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=3331
  bundledCode: "#line 1 \"verify/aoj_other/aoj_3331.test.cpp\"\n#define PROBLEM \"\
    https://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=3331\"\n\n#line 2 \"\
    icpc/template.hpp\"\n\n#include <bits/stdc++.h>\nusing namespace std;\n\nusing\
    \ ll = long long;\n#define REP(i, n) for (int i = 0; i < (n); i++)\ntemplate <class\
    \ T> using V = vector<T>;\ntemplate <class T> ostream& operator<<(ostream &os,\
    \ const V<T>& v) {\n    os << \"[ \";\n    for (auto &vi : v) os << vi << \",\
    \ \";\n    return os << \"]\";\n}\n\n#ifdef LOCAL\n#define show(x) cerr << __LINE__\
    \ << \" : \" << #x << \" = \" << x << endl;\n#else\n#define show(x) true\n#endif\n\
    \n// g++ -g -fsanitize=undefined,address -DLOCAL -std=gnu++17\n#line 2 \"icpc/modint.hpp\"\
    \n\n#line 4 \"icpc/modint.hpp\"\n\nusing uint = unsigned int;\nusing ull = unsigned\
    \ long long;\ntemplate <uint MD> struct Modint {\n    using M = Modint;\n    const\
    \ static M G;\n    uint v;\n    Modint(ll val = 0) { set_v(val % MD + MD); }\n\
    \    M& set_v(uint val) {\n        v = (val < MD) ? val : val - MD;\n        return\
    \ *this;\n    }\n    explicit operator bool() const { return v != 0; }\n    M\
    \ operator-() const { return M() - *this; }\n    M operator+(const M& r) const\
    \ { return M().set_v(v + r.v); }\n    M operator-(const M& r) const { return M().set_v(v\
    \ + MD - r.v); }\n    M operator*(const M& r) const { return M().set_v(ull(v)\
    \ * r.v % MD); }\n    M operator/(const M& r) const { return *this * r.inv();\
    \ }\n    M& operator+=(const M& r) { return *this = *this + r; }\n    M& operator-=(const\
    \ M& r) { return *this = *this - r; }\n    M& operator*=(const M& r) { return\
    \ *this = *this * r; }\n    M& operator/=(const M& r) { return *this = *this /\
    \ r; }\n    bool operator==(const M& r) const { return v == r.v; }\n    M pow(ll\
    \ n) const {\n        M x = *this, r = 1;\n        while (n) {\n            if\
    \ (n & 1) r *= x;\n            x *= x;\n            n >>= 1;\n        }\n    \
    \    return r;\n    }\n    M inv() const { return pow(MD - 2); }\n    friend ostream&\
    \ operator<<(ostream& os, const M& r) { return os << r.v; }\n};\n// using mint\
    \ = Modint<998244353>;\n// template<> const mint mint::G = mint(3);\n#line 2 \"\
    icpc/ntt.hpp\"\n\n#line 4 \"icpc/ntt.hpp\"\n\ntemplate <class Mint> void ntt(bool\
    \ type, V<Mint>& a) {\n    int n = int(a.size()), s = 0;\n    while((1 << s) <\
    \ n) s++;\n    assert(1 << s == n);\n\n    static V<Mint> ep, iep;\n    while\
    \ (int(ep.size()) <= s) {\n        ep.push_back(Mint::G.pow(Mint(-1).v / (1 <<\
    \ ep.size())));\n        iep.push_back(ep.back().inv());\n    }\n    V<Mint> b(n);\n\
    \    for (int i = 1; i <= s; i++) {\n        int w = 1 << (s - i);\n        Mint\
    \ base = type ? iep[i] : ep[i], now = 1;\n        for (int y = 0; y < n / 2; y\
    \ += w) {\n            REP(x, w) {\n                auto l = a[y << 1 | x];\n\
    \                auto r = now * a[y << 1 | x | w];\n                b[y | x] =\
    \ l + r;\n                b[y | x | n >> 1] = l - r;\n            }\n        \
    \    now *= base;\n        }\n        swap(a, b);\n    }\n}\n\ntemplate <class\
    \ Mint> V<Mint> multiply(const V<Mint>& a, const V<Mint>& b) {\n    int n = int(a.size()),\
    \ m = int(b.size());\n    if (!n || !m) return {};\n    if (min(n, m) <= 8) {\n\
    \        V<Mint> ans(n + m - 1);\n        REP(i, n) REP(j, m) ans[i + j] += a[i]\
    \ * b[j];\n        return ans;\n    }\n    int lg = 0;\n    while ((1 << lg) <\
    \ n + m - 1) lg++;\n    int z = 1 << lg;\n    auto a2 = a, b2 = b;\n    a2.resize(z);\n\
    \    b2.resize(z);\n    ntt(false, a2);\n    ntt(false, b2);\n    REP(i, z) a2[i]\
    \ *= b2[i];\n    ntt(true, a2);\n    a2.resize(n + m - 1);\n    Mint iz = Mint(z).inv();\n\
    \    REP(i, n + m - 1) a2[i] *= iz;\n    return a2;\n}\n#line 6 \"verify/aoj_other/aoj_3331.test.cpp\"\
    \n\nusing mint = Modint<998244353>;\ntemplate<> const mint mint::G = mint(3);\n\
    \nint main() {\n    string S;\n    cin >> S;\n    int M = int(S.size());\n   \
    \ V<int> A(M);\n    REP(i, M) A[i] = S[i] - '0';\n    V<mint> p(M, 0);\n    p[0]\
    \ = 1;\n    REP(i, M - 1) p[i + 1] = (p[i] * 10) + 1;\n    mint las = 0;\n   \
    \ mint SM = 0;\n    REP(i, M) SM = SM * 10 + A[i];\n    SM += 1;\n    V<mint>\
    \ B;\n    REP(i, M - 1) {\n        for (int j = 1; j <= 9; j++) {\n          \
    \  B.push_back(p[i] * j - las);\n            las = p[i] * j;\n        }\n    }\n\
    \    for (int j = 1; j <= 10; j++) {\n        int ok = 1;\n        for (int i\
    \ = 0; i < M; i++) {\n            if (A[i] < j) {\n                ok = 0;\n \
    \               break;\n            }\n            if (A[i] > j) {\n         \
    \       ok = 1;\n                break;\n            }\n        }\n        if\
    \ (ok) {\n            B.push_back(p[M - 1] * j - las);\n            las = p[M\
    \ - 1] * j;\n        } else {\n            B.push_back(SM - las);\n          \
    \  break;\n        }\n    }\n    auto Brev = B;\n    reverse(Brev.begin(), Brev.end());\n\
    \    auto C = multiply(B, Brev);\n    for (int k = 1; k <= 9 * M; k++) {\n   \
    \     if (k - 1 + B.size() < C.size()) {\n            cout << C[k - 1 + B.size()]\
    \ << '\\n';\n        } else {\n            cout << 0 << '\\n';\n        }\n  \
    \  }\n    return 0;\n}\n"
  code: "#define PROBLEM \"https://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=3331\"\
    \n\n#include \"icpc/template.hpp\"\n#include \"icpc/modint.hpp\"\n#include \"\
    icpc/ntt.hpp\"\n\nusing mint = Modint<998244353>;\ntemplate<> const mint mint::G\
    \ = mint(3);\n\nint main() {\n    string S;\n    cin >> S;\n    int M = int(S.size());\n\
    \    V<int> A(M);\n    REP(i, M) A[i] = S[i] - '0';\n    V<mint> p(M, 0);\n  \
    \  p[0] = 1;\n    REP(i, M - 1) p[i + 1] = (p[i] * 10) + 1;\n    mint las = 0;\n\
    \    mint SM = 0;\n    REP(i, M) SM = SM * 10 + A[i];\n    SM += 1;\n    V<mint>\
    \ B;\n    REP(i, M - 1) {\n        for (int j = 1; j <= 9; j++) {\n          \
    \  B.push_back(p[i] * j - las);\n            las = p[i] * j;\n        }\n    }\n\
    \    for (int j = 1; j <= 10; j++) {\n        int ok = 1;\n        for (int i\
    \ = 0; i < M; i++) {\n            if (A[i] < j) {\n                ok = 0;\n \
    \               break;\n            }\n            if (A[i] > j) {\n         \
    \       ok = 1;\n                break;\n            }\n        }\n        if\
    \ (ok) {\n            B.push_back(p[M - 1] * j - las);\n            las = p[M\
    \ - 1] * j;\n        } else {\n            B.push_back(SM - las);\n          \
    \  break;\n        }\n    }\n    auto Brev = B;\n    reverse(Brev.begin(), Brev.end());\n\
    \    auto C = multiply(B, Brev);\n    for (int k = 1; k <= 9 * M; k++) {\n   \
    \     if (k - 1 + B.size() < C.size()) {\n            cout << C[k - 1 + B.size()]\
    \ << '\\n';\n        } else {\n            cout << 0 << '\\n';\n        }\n  \
    \  }\n    return 0;\n}\n"
  dependsOn:
  - icpc/template.hpp
  - icpc/modint.hpp
  - icpc/ntt.hpp
  isVerificationFile: true
  path: verify/aoj_other/aoj_3331.test.cpp
  requiredBy: []
  timestamp: '2023-05-15 01:12:22+09:00'
  verificationStatus: TEST_WRONG_ANSWER
  verifiedWith: []
documentation_of: verify/aoj_other/aoj_3331.test.cpp
layout: document
redirect_from:
- /verify/verify/aoj_other/aoj_3331.test.cpp
- /verify/verify/aoj_other/aoj_3331.test.cpp.html
title: verify/aoj_other/aoj_3331.test.cpp
---
